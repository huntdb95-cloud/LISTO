<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Invoice Builder</title>

  <!-- Your existing site styles -->
  <link rel="stylesheet" href="./styles.css" />

  <!-- jsPDF + AutoTable (PDF export) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

  <style>
    /* Small, safe extras that won’t fight your styles.css */
    .page-wrap { max-width: 1100px; margin: 0 auto; padding: 18px; }
    .card { background: rgba(255,255,255,.92); border: 1px solid rgba(0,0,0,.08); border-radius: 12px; padding: 16px; }
    .grid { display: grid; gap: 12px; }
    .grid-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .grid-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
    .row { display:flex; gap: 10px; align-items:center; flex-wrap: wrap; }
    label { display:block; font-size: 0.9rem; opacity: .85; margin-bottom: 6px; }
    input, textarea, select { width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(0,0,0,.15); background: #fff; }
    textarea { min-height: 90px; resize: vertical; }
    table { width:100%; border-collapse: collapse; }
    th, td { border-bottom: 1px solid rgba(0,0,0,.1); padding: 10px; vertical-align: top; }
    th { text-align:left; font-size: .9rem; opacity: .8; }
    .num { text-align: right; white-space: nowrap; }
    .btn {
      border: 0; border-radius: 10px; padding: 10px 14px; cursor: pointer;
      background: #111827; color: #fff; font-weight: 600;
    }
    .btn.secondary { background: #374151; }
    .btn.ghost { background: transparent; color: #111827; border: 1px solid rgba(0,0,0,.15); }
    .btn.danger { background: #b91c1c; }
    .muted { opacity:.8; font-size:.92rem; }
    .totals { margin-left: auto; min-width: 320px; }
    .totals .line { display:flex; justify-content: space-between; padding: 6px 0; }
    .totals .grand { font-weight: 800; font-size: 1.1rem; border-top: 1px solid rgba(0,0,0,.15); padding-top: 10px; margin-top: 8px; }
    .topbar { display:flex; justify-content: space-between; align-items: flex-start; gap: 12px; flex-wrap: wrap; }
    .pill { display:inline-block; padding: 6px 10px; border-radius: 999px; background: rgba(17,24,39,.08); }
    @media (max-width: 860px){
      .grid-2, .grid-3 { grid-template-columns: 1fr; }
      .totals { min-width: 100%; }
    }
  </style>
</head>

<body>
  <!-- If your site already injects header/sidebar, keep those.
       Otherwise, this page still works as a standalone tool. -->

  <div class="page-wrap">
    <div class="topbar">
      <div>
        <h1 style="margin:0 0 6px 0;">Invoice Builder</h1>
        <div class="muted">Create, save, email, and export a basic invoice.</div>
      </div>

      <div class="row">
        <button class="btn ghost" id="btnNew">New</button>
        <button class="btn secondary" id="btnSave">Save</button>
        <button class="btn" id="btnPdf">Download PDF</button>
        <button class="btn ghost" id="btnEmail">Email Draft</button>
      </div>
    </div>

    <div style="height:12px;"></div>

    <div class="card grid grid-2">
      <div>
        <h3 style="margin:0 0 10px 0;">Your Company</h3>
        <div class="grid">
          <div>
            <label>Company / Contractor Name</label>
            <input id="fromName" placeholder="ABC Construction LLC" />
          </div>
          <div>
            <label>Email</label>
            <input id="fromEmail" placeholder="billing@yourcompany.com" />
          </div>
          <div>
            <label>Phone</label>
            <input id="fromPhone" placeholder="(555) 555-5555" />
          </div>
          <div>
            <label>Address</label>
            <textarea id="fromAddress" placeholder="Street&#10;City, State ZIP"></textarea>
          </div>
        </div>
      </div>

      <div>
        <h3 style="margin:0 0 10px 0;">Customer</h3>
        <div class="grid">
          <div>
            <label>Customer Name</label>
            <input id="toName" placeholder="Customer Name" />
          </div>
          <div>
            <label>Customer Email</label>
            <input id="toEmail" placeholder="customer@email.com" />
          </div>
          <div>
            <label>Customer Phone</label>
            <input id="toPhone" placeholder="(555) 555-5555" />
          </div>
          <div>
            <label>Customer Address</label>
            <textarea id="toAddress" placeholder="Street&#10;City, State ZIP"></textarea>
          </div>
        </div>
      </div>
    </div>

    <div style="height:12px;"></div>

    <div class="card grid grid-3">
      <div>
        <label>Invoice #</label>
        <input id="invoiceNumber" placeholder="INV-1001" />
      </div>
      <div>
        <label>Invoice Date</label>
        <input id="invoiceDate" type="date" />
      </div>
      <div>
        <label>Due Date</label>
        <input id="dueDate" type="date" />
      </div>

      <div class="grid" style="grid-column: 1 / -1;">
        <div>
          <label>Project / Description</label>
          <input id="projectName" placeholder="Kitchen remodel - phase 1" />
        </div>
      </div>
    </div>

    <div style="height:12px;"></div>

    <div class="card">
      <div class="row" style="justify-content: space-between;">
        <h3 style="margin:0;">Line Items</h3>
        <button class="btn ghost" id="btnAddItem">+ Add Item</button>
      </div>

      <div style="height:10px;"></div>

      <div style="overflow:auto;">
        <table id="itemsTable">
          <thead>
            <tr>
              <th style="min-width:260px;">Description</th>
              <th style="width:90px;" class="num">Qty</th>
              <th style="width:140px;" class="num">Unit Price</th>
              <th style="width:140px;" class="num">Line Total</th>
              <th style="width:90px;"></th>
            </tr>
          </thead>
          <tbody id="itemsBody"></tbody>
        </table>
      </div>

      <div style="height:14px;"></div>

      <div class="row">
        <div class="grid grid-3" style="flex:1; min-width: 320px;">
          <div>
            <label>Tax %</label>
            <input id="taxRate" type="number" step="0.01" min="0" placeholder="0" />
          </div>
          <div>
            <label>Discount ($)</label>
            <input id="discount" type="number" step="0.01" min="0" placeholder="0" />
          </div>
          <div>
            <label>Deposit Paid ($)</label>
            <input id="deposit" type="number" step="0.01" min="0" placeholder="0" />
          </div>
        </div>

        <div class="totals">
          <div class="line"><span>Subtotal</span><span id="subtotalOut">$0.00</span></div>
          <div class="line"><span>Tax</span><span id="taxOut">$0.00</span></div>
          <div class="line"><span>Discount</span><span id="discountOut">$0.00</span></div>
          <div class="line"><span>Deposit</span><span id="depositOut">$0.00</span></div>
          <div class="line grand"><span>Total Due</span><span id="totalOut">$0.00</span></div>
          <div style="margin-top:8px;" class="muted">
            <span class="pill" id="statusPill">Not saved</span>
          </div>
        </div>
      </div>

      <div style="height:12px;"></div>

      <div class="grid grid-2">
        <div>
          <label>Notes</label>
          <textarea id="notes" placeholder="Thank you for your business."></textarea>
        </div>
        <div>
          <label>Payment Instructions</label>
          <textarea id="paymentInstructions" placeholder="Zelle: your@email.com&#10;Check payable to: ..."></textarea>
        </div>
      </div>

      <div style="height:12px;"></div>

      <div>
        <label>Recent Saved Invoices</label>
        <div class="row">
          <select id="savedInvoicesSelect" style="max-width:520px;">
            <option value="">— Load a saved invoice —</option>
          </select>
          <button class="btn ghost" id="btnLoad">Load</button>
          <button class="btn danger" id="btnDelete">Delete</button>
        </div>
        <div class="muted" style="margin-top:8px;">
          Email drafts can’t attach PDFs automatically; export the PDF and attach it in your email client.
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase config (your existing file) + tool script -->
  <script type="module" src="./invoice.js"></script>
</body>
</html>
