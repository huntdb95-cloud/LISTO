<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Invoice Builder</title>

  <!-- Your existing site styles -->
  <link rel="stylesheet" href="../styles.css" />

  <!-- jsPDF + AutoTable (PDF export on client) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

  <style>
    .page-wrap { max-width: 1100px; margin: 0 auto; padding: 18px; }
    .card { background: rgba(255,255,255,.92); border: 1px solid rgba(0,0,0,.08); border-radius: 12px; padding: 16px; }
    .grid { display: grid; gap: 12px; }
    .grid-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .grid-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
    .row { display:flex; gap: 10px; align-items:center; flex-wrap: wrap; }
    label { display:block; font-size: 0.9rem; opacity: .85; margin-bottom: 6px; }
    input, textarea, select { width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(0,0,0,.15); background: #fff; }
    textarea { min-height: 90px; resize: vertical; }
    table { width:100%; border-collapse: collapse; }
    th, td { border-bottom: 1px solid rgba(0,0,0,.1); padding: 10px; vertical-align: top; }
    th { text-align:left; font-size: .9rem; opacity: .8; }
    .num { text-align: right; white-space: nowrap; }
    .btn {
      border: 0; border-radius: 10px; padding: 10px 14px; cursor: pointer;
      background: #111827; color: #fff; font-weight: 600;
    }
    .btn.secondary { background: #374151; }
    .btn.ghost { background: transparent; color: #111827; border: 1px solid rgba(0,0,0,.15); }
    .btn.danger { background: #b91c1c; }
    .btn:disabled { opacity: .6; cursor: not-allowed; }
    .muted { opacity:.8; font-size:.92rem; }
    .totals { margin-left: auto; min-width: 320px; }
    .totals .line { display:flex; justify-content: space-between; padding: 6px 0; }
    .totals .grand { font-weight: 800; font-size: 1.1rem; border-top: 1px solid rgba(0,0,0,.15); padding-top: 10px; margin-top: 8px; }
    .topbar { display:flex; justify-content: space-between; align-items: flex-start; gap: 12px; flex-wrap: wrap; }
    .pill { display:inline-block; padding: 6px 10px; border-radius: 999px; background: rgba(17,24,39,.08); }
    .pill.ok { background: rgba(16,185,129,.14); }
    .pill.warn { background: rgba(245,158,11,.18); }
    .pill.err { background: rgba(239,68,68,.18); }
    @media (max-width: 860px){
      .grid-2, .grid-3 { grid-template-columns: 1fr; }
      .totals { min-width: 100%; }
    }
  </style>
</head>

<body data-page="invoice" data-requires-auth="true">
<a class="skip-link" href="#main">Skip to content</a>
<header class="site-header">
<div class="container header-inner">
<div class="header-left">
<button aria-controls="sideNav" aria-expanded="false" class="sidebar-toggle" type="button"><span class="sr-only">Open navigation</span><span aria-hidden="true" class="hamburger"></span></button>
<a href="../account/account.html" class="header-avatar" id="headerAvatar" title="My Account" aria-label="My Account" hidden>
<img id="headerAvatarImage" alt="Profile" style="display: none;" />
<span id="headerAvatarInitials" class="header-avatar-initials"></span>
</a>
</div>
<a aria-label="Listo Home" class="brand" href="../dashboard.html">
<img alt="Listo" class="brand-logo" src="../images/logo2.png"/>
</a>

<div class="header-actions">
</div>
</div>
</header><div class="layout"><aside aria-label="Primary" class="sidebar"><div class="nav-menu sidebar-nav" id="sideNav">
<a class="sidebar-link nav-link" data-i18n="nav.dashboard" href="../dashboard.html">Home</a>
<a class="sidebar-link nav-link" data-i18n="nav.contracts" href="../contracts/contracts.html">Contracts</a>
<a class="sidebar-link nav-link" data-i18n="nav.bookkeeping" href="../bookkeeping/bookkeeping.html">Bookkeeping</a>
<div class="sidebar-submenu">
  <button class="sidebar-link sidebar-submenu-toggle" data-i18n="nav.tools">Tools</button>
  <div class="sidebar-submenu-content">
    <a class="sidebar-link sidebar-submenu-link" data-i18n="nav.audit" href="../audit/audit.html">Audit Help</a>
    <a class="sidebar-link sidebar-submenu-link" data-i18n="nav.contractScanner" href="../contract-scanner/contract-scanner.html">Contract Scanner</a>
    <a class="sidebar-link sidebar-submenu-link" data-i18n="nav.invoiceBuilder" href="../invoice/invoice.html">Invoice Builder</a>
  </div>
</div>
<a class="sidebar-link nav-link" data-i18n="nav.support" href="../support.html">Support</a>
</div></aside><main id="main">
  <div class="page-wrap">
    <div class="topbar">
      <div>
        <h1 style="margin:0 0 6px 0;" data-i18n="invoice.title">Invoice Builder</h1>
        <div class="muted" data-i18n="invoice.pageDescription">Create, save, export, and send invoices (PDF attached via SendGrid).</div>
      </div>

      <div class="row">
        <button class="btn ghost" id="btnNew" data-i18n="invoice.new">New</button>
        <button class="btn secondary" id="btnSave" data-i18n="invoice.save">Save</button>
        <button class="btn" id="btnPdf" data-i18n="invoice.downloadPdf">Download PDF</button>
        <button class="btn" id="btnSendEmail" data-i18n="invoice.sendEmail">Send Invoice (Email PDF)</button>
      </div>
    </div>

    <div style="height:12px;"></div>

    <div class="card grid grid-2">
      <div>
        <h3 style="margin:0 0 10px 0;" data-i18n="invoice.yourCompany">Your Company</h3>
        <div class="grid">
          <div>
            <label data-i18n="invoice.companyName">Company / Contractor Name</label>
            <input id="fromName" placeholder="ABC Construction LLC" />
          </div>
          <div>
            <label data-i18n="invoice.replyEmail">Email (Reply-To)</label>
            <input id="fromEmail" placeholder="billing@yourcompany.com" />
          </div>
          <div>
            <label data-i18n="invoice.phone">Phone</label>
            <input id="fromPhone" placeholder="(555) 555-5555" />
          </div>
          <div>
            <label data-i18n="invoice.address">Address</label>
            <textarea id="fromAddress" placeholder="Street&#10;City, State ZIP"></textarea>
          </div>
        </div>
      </div>

      <div>
        <h3 style="margin:0 0 10px 0;" data-i18n="invoice.customer">Customer</h3>
        <div class="grid">
          <div style="grid-column: 1 / -1;">
            <label data-i18n="invoice.selectBuilder">Select Builder (Optional)</label>
            <select id="selectBuilder" style="margin-bottom: 8px;">
              <option value="">‚Äî Select a builder ‚Äî</option>
            </select>
            <select id="selectJob" style="display: none;">
              <option value="">‚Äî Select a job (optional) ‚Äî</option>
            </select>
          </div>
          <div>
            <label data-i18n="invoice.customerName">Customer Name</label>
            <input id="toName" placeholder="Customer Name" />
          </div>
          <div>
            <label data-i18n="invoice.customerEmail">Customer Email</label>
            <input id="toEmail" placeholder="customer@email.com" />
          </div>
          <div>
            <label data-i18n="invoice.customerPhone">Customer Phone</label>
            <input id="toPhone" placeholder="(555) 555-5555" />
          </div>
          <div>
            <label data-i18n="invoice.customerAddress">Customer Address</label>
            <textarea id="toAddress" placeholder="Street&#10;City, State ZIP"></textarea>
          </div>
        </div>
      </div>
    </div>

    <div style="height:12px;"></div>

    <div class="card grid grid-3">
      <div>
        <label data-i18n="invoice.invoiceNumber">Invoice #</label>
        <input id="invoiceNumber" placeholder="INV-1001" />
      </div>
      <div>
        <label data-i18n="invoice.invoiceDate">Invoice Date</label>
        <input id="invoiceDate" type="date" />
      </div>
      <div>
        <label data-i18n="invoice.dueDate">Due Date</label>
        <input id="dueDate" type="date" />
      </div>

      <div class="grid" style="grid-column: 1 / -1;">
        <div>
          <label data-i18n="invoice.projectName">Project / Description</label>
          <input id="projectName" placeholder="Kitchen remodel - phase 1" />
        </div>
      </div>
    </div>

    <div style="height:12px;"></div>

    <div class="card">
      <div class="row" style="justify-content: space-between;">
        <h3 style="margin:0;" data-i18n="invoice.lineItems">Line Items</h3>
        <button class="btn ghost" id="btnAddItem" data-i18n="invoice.addItem">+ Add Item</button>
      </div>

      <div style="height:10px;"></div>

      <div style="overflow:auto;">
        <table id="itemsTable">
          <thead>
            <tr>
              <th style="min-width:260px;" data-i18n="invoice.description">Description</th>
              <th style="width:90px;" class="num" data-i18n="invoice.quantity">Qty</th>
              <th style="width:140px;" class="num" data-i18n="invoice.unitPrice">Unit Price</th>
              <th style="width:140px;" class="num" data-i18n="invoice.lineTotal">Line Total</th>
              <th style="width:90px;"></th>
            </tr>
          </thead>
          <tbody id="itemsBody"></tbody>
        </table>
      </div>

      <div style="height:14px;"></div>

      <div class="row">
        <div class="grid grid-3" style="flex:1; min-width: 320px;">
          <div>
            <label data-i18n="invoice.taxRate">Tax %</label>
            <input id="taxRate" type="number" step="0.01" min="0" placeholder="0" />
          </div>
          <div>
            <label data-i18n="invoice.discount">Discount ($)</label>
            <input id="discount" type="number" step="0.01" min="0" placeholder="0" />
          </div>
          <div>
            <label data-i18n="invoice.deposit">Deposit Paid ($)</label>
            <input id="deposit" type="number" step="0.01" min="0" placeholder="0" />
          </div>
        </div>

        <div class="totals">
          <div class="line"><span data-i18n="invoice.subtotal">Subtotal</span><span id="subtotalOut">$0.00</span></div>
          <div class="line"><span data-i18n="invoice.tax">Tax</span><span id="taxOut">$0.00</span></div>
          <div class="line"><span data-i18n="invoice.discountLabel">Discount</span><span id="discountOut">$0.00</span></div>
          <div class="line"><span data-i18n="invoice.depositLabel">Deposit</span><span id="depositOut">$0.00</span></div>
          <div class="line grand"><span data-i18n="invoice.totalDue">Total Due</span><span id="totalOut">$0.00</span></div>

          <div style="margin-top:8px;" class="muted">
            <span class="pill" id="statusPill">Not saved</span>
          </div>

          <div style="margin-top:8px;" class="muted" id="sendResult"></div>
        </div>
      </div>

      <div style="height:12px;"></div>

      <div class="grid grid-2">
        <div>
          <label data-i18n="invoice.notes">Notes</label>
          <textarea id="notes" placeholder="Thank you for your business."></textarea>
        </div>
        <div>
          <label data-i18n="invoice.paymentInstructions">Payment Instructions</label>
          <textarea id="paymentInstructions" placeholder="Zelle: your@email.com&#10;Check payable to: ..."></textarea>
        </div>
      </div>

      <div style="height:12px;"></div>

      <div>
        <label data-i18n="invoice.recentInvoices">Recent Saved Invoices</label>
        <div class="row">
          <select id="savedInvoicesSelect" style="max-width:520px;">
            <option value="">‚Äî Load a saved invoice ‚Äî</option>
          </select>
          <button class="btn ghost" id="btnLoad" data-i18n="invoice.loadInvoice">Load</button>
          <button class="btn danger" id="btnDelete" data-i18n="invoice.deleteInvoice">Delete</button>
        </div>
        <div class="muted" style="margin-top:8px;" data-i18n="invoice.sendNote">
          "Send Invoice" emails a PDF attachment through your Firebase backend + SendGrid.
        </div>
      </div>
    </div>
  </div>
</main></div>

<!-- Mobile Bottom Navigation -->
<nav class="mobile-bottom-nav" aria-label="Mobile navigation">
  <div class="mobile-bottom-nav-items">
    <a href="../dashboard.html" class="mobile-bottom-nav-item" data-nav="home">
      <div class="mobile-bottom-nav-icon">üè†</div>
      <div class="mobile-bottom-nav-label" data-i18n="nav.dashboard">Home</div>
    </a>
    <a href="../contracts/contracts.html" class="mobile-bottom-nav-item" data-nav="contracts">
      <div class="mobile-bottom-nav-icon">üìÑ</div>
      <div class="mobile-bottom-nav-label" data-i18n="nav.contracts">Contracts</div>
    </a>
    <a href="../bookkeeping/bookkeeping.html" class="mobile-bottom-nav-item" data-nav="bookkeeping">
      <div class="mobile-bottom-nav-icon">üìä</div>
      <div class="mobile-bottom-nav-label" data-i18n="nav.bookkeeping">Bookkeeping</div>
    </a>
    <a href="../tools/tools.html" class="mobile-bottom-nav-item active" data-nav="tools">
      <div class="mobile-bottom-nav-icon">üîß</div>
      <div class="mobile-bottom-nav-label" data-i18n="nav.tools">Tools</div>
    </a>
    <a href="../settings/settings.html" class="mobile-bottom-nav-item" data-nav="settings">
      <div class="mobile-bottom-nav-icon">‚öôÔ∏è</div>
      <div class="mobile-bottom-nav-label" data-i18n="nav.settings">Settings</div>
    </a>
  </div>
</nav>

<script src="../scripts.js" type="module"></script>
<script type="module" src="./invoice.js"></script>
</body>
</html>
